#  Комплекс для детекции масок и позы

Модульный конвейер для **детекции масок на лице** в реальном времени и **визуализации верхней части тела**, на базе OpenCV, MediaPipe и scikit-learn.


##  Возможности

### 1. **Детектор масок**
- **3 класса**: *Маска надета*, *Без маски*, *Маска надета неправильно*  
- **Признаки как при обучении**:  
  - Гистограммы BGR/HSV по зонам (верх/низ лица)  
  - Разницы средних цветов между зонами  
  - Текстура (Лапласиан, Собель), контраст яркости  
- **Модель**: `RandomForest` (300 деревьев, баланс классов)  
- **Усиленная аугментация**: яркость, цвет, отражение — особенно для дефицитных классов  
- **Резервирование моделей**: загружает первую доступную из списка  
- **Трекинг по ID**: TTL + IoU — стабилизирует метки во времени  

### 2. **Визуализатор позы**
- **MediaPipe Pose** с кастомными соединениями:  
  - плечи → локти → запястья  
  - центр лица → центр плеч («спина»)  
- **Минималистичная зелёная разметка**  
- **Автоматическая загрузка/сохранение**: образец `astronaut` или свои изображения  
- Поддержка пакетной обработки

---

##  Требования

```txt
opencv-python>=4.5.0
numpy>=1.19.0
scikit-learn>=1.0.0
joblib>=1.0.0
mediapipe>=0.8.0
scikit-image>=0.19.0  # только для образца

Установка:
```bash
pip install -r requirements.txt


Датасет ДЛЯ ML
https://www.kaggle.com/datasets/andrewmvd/face-mask-detection/data

ДЛЯ YOLO 
https://github.com/iAmEthanMai/mask-detection-dataset
